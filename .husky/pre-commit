echo "Running pre-commit hook"

# Get only staged files (new/changed)
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx|js|jsx|mjs|json)$' || true)

if [ -z "$STAGED_FILES" ]; then
  echo "No files to lint"
  exit 0
fi

echo "Linting staged files..."
npx eslint --fix $STAGED_FILES

if [ $? -ne 0 ]; then
  echo "❌ Linting failed"
  exit 1
fi

# Stage the fixed files
git add $STAGED_FILES

echo "✅ Linting passed, changes staged automatically"
exit 0
